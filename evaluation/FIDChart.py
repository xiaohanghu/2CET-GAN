"""
2CET-GAN
Copyright (c) 2022-present, Xiaohang Hu.
This work is licensed under the MIT License.
"""

import matplotlib.pyplot as plot
import numpy as np

# 2.8.8.2 best 65000
fid_e_z_test_V2_8_8_2 = [
    # 209.49640020343276,
    # 90.13784098521678,
    # 66.7783783739523,
    # 50.61916716918671,
    45.40153095988977, 42.02587080286734, 38.48608350030066, 35.74761965188783, 34.8374253895639,
    35.10858298202486, 34.886617074017195, 34.88173683988904, 35.60101703148692, 32.7709442543763,
    32.51780038612587, 33.06943208825935, 31.49965912892243, 33.54485212377668, 32.63023028511299,
    32.42273963359611, 34.39375883109907, 34.185843485073235
    # , 33.54861554010699, 33.07225787991828
]
fid_e_z_train_V2_8_8_2 = [
    # 180.64913697172292,
    # 49.0951014281338,
    # 26.982413603420902,
    # 17.96788716605109,
    14.389116611605246, 10.327506284753088, 8.93614472886772, 7.97174130157074, 7.203114136746013,
    6.511467317694171, 6.206939843123858, 5.827496837438539, 5.5674733625717465, 5.375620390691888,
    5.333883791835214, 5.122374692604649, 5.145950970313898, 4.944552692628619, 4.7985552721640286,
    4.904156425768583, 4.666293165813877, 4.802750006285805
    # , 4.629637997678746, 4.745738421840989
]
fid_e_r_test_V2_8_8_2 = [
    # 215.73435829579162,
    # 99.37105667008622,
    # 75.37189916028981,
    # 57.40352423009552,
    53.15893741325095, 45.70829796176702, 40.22809025812783, 37.994097652517326, 35.362948144339846,
    34.904624036037866, 33.215331155089885, 35.08809517983582, 34.544438277007444, 32.49199499975323,
    32.945748022696655, 32.230245847336064, 31.332979344708132, 32.58626940643732, 33.02401338603422,
    31.85628069027087, 34.15446737298164, 33.028986606913065
    # , 33.05722091066797, 32.93279148699739
]
fid_e_r_train_V2_8_8_2 = [
    # 184.71063412533866,
    # 55.59534440808823,
    # 31.641687058881587,
    # 22.589590856441866,
    19.984306097327078, 11.95268603020407, 9.99470229681804, 8.840181393439858, 7.83041106333709,
    6.979170935048143, 6.646222179651412, 6.2150403027287275, 5.9408015308588045, 5.769438219697127,
    5.607093702432581, 5.476119844236746, 5.467026760670127, 5.2313690487217155, 5.11844873224252,
    5.099396768590824, 4.995207567026394, 5.111304281459599
    # , 4.896371378238067, 5.026092020641143
]

fid_e_z_test_V2_9_0_0 = [40.1, 35.4, 35.7, 34.2, 32.5, 31.4, 32.3, 32.1, 30.7, 31.1, 31.9, 31.1, 31.5, 31.8, 32.5, 32.5,
                         30.5, 32., 32.1, 31.8]
fid_e_z_train_V2_9_0_0 = [13.4, 9.6, 8.5, 7.8, 6.9, 6.5, 6.2, 5.9, 5.9, 5.7, 5.5, 5.4, 5.2, 5.4, 5.2, 5.2, 5.1, 5.2,
                          5.1, 5.]
fid_e_r_test_V2_9_0_0 = [48.3, 37.3, 36.2, 34.4, 32.3, 30.1, 31.7, 31.5, 31.1, 30.8, 32.0, 31.4, 31.7, 31.7, 32.6, 32.4,
                         30.1, 31.5, 31.1, 31.9]
fid_e_r_train_V2_9_0_0 = [17.8, 11.6, 9.7, 8.4, 7.4, 6.9, 6.5, 6.4, 6.3, 6.1, 6.0, 5.8, 5.6, 5.6, 5.5, 5.5, 5.3, 5.3,
                          5.3, 5.1]

RafD_gaze_V1_fid_e_z_test = [28.968886457323777, 24.541270779988437, 21.62702980607763, 20.088154798590356,
                             20.314634694230932, 20.40745966381113, 20.7410914410371, 20.87686385292931,
                             19.901214243090095, 20.638293788628403, 19.99614590232295, 19.777851735738373,
                             19.373372691154717, 19.550886536559098, 19.246443721119103, 19.657158854365385,
                             19.41937942777414, 19.765487850421522, 19.50392235348889, 19.14161889888176]
RafD_gaze_V1_fid_e_z_train = [12.544874460748694, 7.789739790811493, 6.910349887993889, 6.381204649593509,
                              6.273090892401532, 5.986224131441369, 5.916711631802524, 5.52457791001892,
                              5.387109964735588, 5.20614611031383, 4.939608669445284, 4.945871833473136,
                              4.812503593650133, 4.656134172514628, 4.535259266024018, 4.471848258679811,
                              4.3387322783795295, 4.297775280978245, 4.414436194017863, 4.240321990003184]
RafD_gaze_V1_fid_e_r_test = [32.44886171963104, 26.78336170488889, 23.130106207639884, 21.538647394918335,
                             21.222261638999843, 21.727602728517276, 22.019286593125116, 21.159662561556406,
                             20.441460748439045, 21.255666321604398, 20.419989735669827, 20.214933174556247,
                             19.840988896668765, 19.877579829801057, 19.697304941916844, 20.526717072080444,
                             19.93799301050818, 20.230047780266155, 19.871614994787148, 19.534295602661853]
RafD_gaze_V1_fid_e_r_train = [14.902831651078854, 8.221220707031609, 7.256910214930691, 6.916631493216528,
                              6.624075134206342, 6.361071130768618, 6.344483174669189, 5.891243883875015,
                              5.573603057109822, 5.367137499140908, 5.157660277931132, 5.064434309411437,
                              4.921040406289559, 4.745442373552223, 4.736279476919855, 4.58802941245542,
                              4.446412036162998, 4.368114835305876, 4.491705437806518, 4.296394797885362]

# fid_e_z
# y_test = RafD_gaze_V1_fid_e_r_test
# y_train = RafD_gaze_V1_fid_e_r_train
# y_test = RafD_gaze_V1_fid_e_z_test
# y_train = RafD_gaze_V1_fid_e_z_train
y_test = fid_e_z_test_V2_9_0_0
y_train = fid_e_z_train_V2_9_0_0

n = 12
n = len(y_test)
y_test = y_test[:n]
y_train = y_train[:n]

print(len(y_test))
x0 = np.array([
    # 1000
    # , 2000
    #    , 3000
    # , 4000
], np.float64)
n1 = len(y_test) - len(x0)
x1 = np.linspace(5000, 5000 * n1, n1)
print(x0.dtype)
x = np.concatenate((x0, x1))
print(x)

font_size = 16
# y2 = [c_y1(i) for i in x]
plot.figure(figsize=(10, 7))
# plot.plot(x, y_test, label="test set", color='#DF732C')
plot.plot(x, y_test, label="test set", color='black', linestyle='--', marker='o')
# plot.plot(x, y_train, label="train set", color='#42946B')
plot.plot(x, y_train, label="train set", color='black', linestyle='-', marker='o')
plot.legend(loc='right', frameon=False, fontsize=font_size)
plot.xticks(x, fontsize=font_size, rotation=0)
# plot.gca().set_yticklabels(plot.gca().get_yticks(), fontsize=12, rotation=0)
plot.yticks(fontsize=font_size)
plot.xlabel('Training steps', fontsize=font_size, fontweight='bold')
plot.ylabel('FID', fontsize=font_size, fontweight='bold')

# after plotting the data, format the labels
current_values = plot.gca().get_xticks()
# using format string '{:.0f}' here but you can choose others
xticklabels = []
for x in current_values:
    if x % 10000 != 0:
        l = "{:.0f}K".format(x / 1000)
    else:
        l = ""
    xticklabels.append(l)
plot.gca().set_xticklabels(xticklabels)
# plot.axis('equal')

ax = plot.gca()
# ax为两条坐标轴的实例
# ax.xaxis.set_major_locator(MultipleLocator(1))
# 把x轴的主刻度设置为1的倍数
# ax.yaxis.set_major_locator(MultipleLocator(1))
# plot.xlim(-5, 10)
# plot.ylim(-1, 1)

# 去掉边框
ax.spines['top'].set_color('none')
ax.spines['right'].set_color('none')

# fig = plot.figure()
# fig.tight_layout()
plot.subplots_adjust(left=0.08, right=0.9, top=0.95, bottom=0.15)

# 移位置 设为原点相交
# ax.xaxis.set_ticks_position('bottom')
# ax.spines['bottom'].set_position(('data', 0))
# ax.yaxis.set_ticks_position('left')
# ax.spines['left'].set_position(('data', 0))
plot.savefig('output/FID_line.png')
plot.show()
